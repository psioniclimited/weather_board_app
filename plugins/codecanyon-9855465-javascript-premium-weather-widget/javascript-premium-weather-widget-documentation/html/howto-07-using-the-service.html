<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>WiseLoop JavaScript Premium Weather Widget: Using the Data Service</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="doxygen-wl-logo.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">WiseLoop JavaScript Premium Weather Widget&#160;<span id="projectnumber">2.1.1</span></div>
   <div id="projectbrief">Weather Condition & Forecast Script</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('howto-07-using-the-service.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Using the Data Service </div>  </div>
</div>
<div class="contents">
<div class="textblock"><p>Along with the directive that displays the weather widget, the module offers a <b>service</b> that is able to provide <b>raw weather data and forecast</b> also.<br/>
 The service can be used to build other directives or it can be used to make a standalone application that presents the weather conditions in own UI or use it in any other scenarios.<br/>
 Bottom line is that the service will offer raw weather data on demand without any UI, leaving the developer the freedom of choice to decide what to do with the data.</p>
<p>In this section, we will build a simple JavaScript AngularJS application that will get the weather conditions using the data service.<br/>
 To keep the things as simple as possible, the data will be displayed inside a classical alert box without any other UI or DOM elements. Also, please visit <a href="https://developer.forecast.io">https://developer.forecast.io</a> to get a forecast.io API key in order to configure the script properly. It's free and very easy. After getting the key, just replace the <em>your-developer.forecast.io-key</em> with your actual key.</p>
<h2><a class="anchor" id="directive-file-structure"></a>
The server file structure</h2>
<p>The following file structure is assumed to exists on the server as this is the default structure that the package comes with. </p>
<div class="image">
<img src="tut-file-structure.png" alt="tut-file-structure.png"/>
<div class="caption">
The assumed server file structure</div></div>
<p> The file we are editing is <b>/sample/index.html</b></p>
<p>A very basic JavaScript AngularJS app using the weather forecast data service should look like: </p>
<div class="fragment"><pre class="fragment">&lt;html ng-app=<span class="stringliteral">&quot;demo-app&quot;</span> ng-controller=<span class="stringliteral">&quot;demoAppController&quot;</span>&gt;
    &lt;head&gt;
        &lt;link rel=<span class="stringliteral">&quot;stylesheet&quot;</span> href=<span class="stringliteral">&quot;../bins/lib/bootstrap/css/bootstrap.min.css&quot;</span>/&gt;
        &lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span> src=<span class="stringliteral">&quot;../bins/lib/skycons/skycons.js&quot;</span>&gt;&lt;/script&gt;
        &lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span> src=<span class="stringliteral">&quot;../bins/lib/angular/angular.min.js&quot;</span>&gt;&lt;/script&gt;
        &lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span> src=<span class="stringliteral">&quot;../bins/lib/angular/angular-animate.min.js&quot;</span>&gt;&lt;/script&gt;
        &lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span> src=<span class="stringliteral">&quot;https://maps.googleapis.com/maps/api/js?libraries=places&quot;</span>&gt;&lt;/script&gt;
        &lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span> src=<span class="stringliteral">&quot;../bins/wl-ng-weather.js&quot;</span>&gt;&lt;/script&gt;
        &lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span>&gt;
            <span class="comment">//configuration</span>
            angular.module(<span class="stringliteral">&#39;wl-ng-weather&#39;</span>).value(<span class="stringliteral">&#39;bins&#39;</span>, <span class="stringliteral">&#39;../bins&#39;</span>);
            angular.module(<span class="stringliteral">&#39;wl-ng-weather&#39;</span>).value(<span class="stringliteral">&#39;apikey&#39;</span>, <span class="stringliteral">&#39;your-forecast.io-key&#39;</span>);
            <span class="comment">//create an AngularJS module with a dependency to our weather forecast module</span>
            var demoApp = angular.module(<span class="stringliteral">&#39;demo-app&#39;</span>, [<span class="stringliteral">&#39;wl-ng-weather&#39;</span>]);
            <span class="comment">//declare a controller with a dependency on the data service (wlNgWForecastIo)</span>
            demoApp.controller(<span class="stringliteral">&#39;demoAppController&#39;</span>, function(wlNgWForecastIo) {
                <span class="comment">//get the weather for the North Pole (latitude = 90, longitude = 0)</span>
                wlNgWForecastIo.get(90, 0)
                    .then(function(weather) {
                        <span class="comment">//on success, display the weather</span>
                        alert(JSON.stringify(weather));
                    }, function(error) {
                        <span class="comment">//on error ...</span>
                        alert(error);
                    });
            });
        &lt;/script&gt;
    &lt;/head&gt;
&lt;/html&gt;
</pre></div><p> Looking at the JavaScript code above, after configuring the module, we created a basic AngularJS module (application) called <b>demo-app</b> with a dependency to the weather data service <b>wl-ng-weather</b>: </p>
<div class="fragment"><pre class="fragment">var demoApp = angular.module(<span class="stringliteral">&#39;demo-app&#39;</span>, [<span class="stringliteral">&#39;wl-ng-weather&#39;</span>]);
</pre></div><p> Then, we created a controller inside the demo application having a dependency to the weather data service (wlNgWForecastIo): </p>
<div class="fragment"><pre class="fragment">demoApp.controller(<span class="stringliteral">&#39;demoAppController&#39;</span>, function(wlNgWForecastIo) {
    <span class="comment">//get the weather for the North Pole (latitude = 90, longitude = 0)</span>
    wlNgWForecastIo.get(90, 0)
        .then(function(weather) {
            alert(JSON.stringify(weather));
        }, function(error) {
            alert(error);
        });
});
</pre></div><p> The code above is pretty much self explanatory: <b>get()</b> method of the service is called and if everything goes fine, the weather taken from forecast.io is displayed inside an alert box. </p>
<div class="image">
<img src="tut-data-service.png" alt="tut-data-service.png"/>
<div class="caption">
Data Service Sample App</div></div>
 <dl class="note"><dt><b>Note:</b></dt><dd>The sample above is available under the same /sample/ directory of the downloaded package. </dd></dl>
</div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
